# Better Stack Vector Configuration for BattleOne Infrastructure
sources:
  # Docker container logs
  docker_logs:
    type: docker_logs

  # Host metrics  
  host_metrics:
    type: host_metrics
    collectors:
      - cpu
      - memory
      - disk
      - network
    scrape_interval_secs: 30

# Data transformations
transforms:
  # Format for Better Stack
  format_logs:
    type: remap
    inputs:
      - "docker_logs"
      - "host_metrics"
    source: |
      .timestamp = now()
      .hostname = "battleone-droplet"
      .environment = "production"
      .project = "battleone"

# Data sinks
sinks:
  # Better Stack with custom host
  better_stack:
    type: http
    inputs:
      - "format_logs"
    uri: "https://${BETTERSTACK_INGESTION_HOST}/"
    method: post
    encoding:
      codec: json
    auth:
      strategy: "bearer"
      token: "${BETTERSTACK_SOURCE_TOKEN}"
    compression: gzip
    healthcheck:
      enabled: true
    buffer:
      type: memory
      max_events: 500
      when_full: block
    request:
      timeout_secs: 30
      retry_attempts: 3